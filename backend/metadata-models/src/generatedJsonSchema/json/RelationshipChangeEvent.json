{
  "definitions" : {
    "RelationshipChangeEvent" : {
      "description" : "Kafka event for proposing a relationship change between two entities.\nFor example, when dataset1 establishes a new downstream relationship with dataset2.",
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "auditHeader" : {
          "default" : null,
          "description" : "Kafka audit header containing metadata about the message itself.\nIncludes information like message ID, timestamp, and server details.",
          "$ref" : "#/definitions/KafkaAuditHeader"
        },
        "sourceUrn" : {
          "description" : "The URN (Uniform Resource Name) of the source entity in the relationship.\nIn a downstream relationship example, this would be the URN of the upstream dataset.",
          "type" : "string"
        },
        "destinationUrn" : {
          "description" : "The URN of the destination entity in the relationship.\nIn a downstream relationship example, this would be the URN of the downstream dataset.",
          "type" : "string"
        },
        "operation" : {
          "description" : "The operation being performed on this relationship.\nTypically includes operations like ADD, REMOVE, or RESTATE.",
          "$ref" : "#/definitions/RelationshipChangeOperation"
        },
        "relationshipType" : {
          "description" : "The type/category of relationship being established or modified.\nExamples: \"DownstreamOf\", \"Contains\", \"OwnedBy\", \"DerivedFrom\", etc.",
          "type" : "string"
        },
        "lifecycleOwner" : {
          "default" : null,
          "description" : "The system or service responsible for managing the lifecycle of this relationship.\nThis helps identify which component has authority over the relationship.",
          "type" : "string"
        },
        "via" : {
          "default" : null,
          "description" : "Information about how or through what means this relationship was established.\nCould indicate a specific pipeline, process, or tool that discovered/created the relationship.",
          "type" : "string"
        },
        "properties" : {
          "default" : null,
          "description" : "Additional custom properties associated with this relationship.\nAllows for flexible extension without changing the schema.",
          "type" : "object",
          "additionalProperties" : {
            "type" : "string"
          }
        },
        "auditStamp" : {
          "description" : "Stores information about who made this change and when.\nContains the actor (user or system) that performed the action and the timestamp.",
          "$ref" : "#/definitions/AuditStamp"
        }
      },
      "required" : [ "sourceUrn", "destinationUrn", "operation", "relationshipType", "auditStamp" ]
    },
    "KafkaAuditHeader" : {
      "description" : "This header records information about the context of an event as it is emitted into kafka and is intended to be used by the kafka audit application.  For more information see go/kafkaauditheader",
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "time" : {
          "description" : "The time at which the event was emitted into kafka.",
          "type" : "integer",
          "format" : "int64",
          "minimum" : -9223372036854775808,
          "maximum" : 9223372036854775807
        },
        "server" : {
          "description" : "The fully qualified name of the host from which the event is being emitted.",
          "type" : "string"
        },
        "instance" : {
          "default" : null,
          "description" : "The instance on the server from which the event is being emitted. e.g. i001",
          "type" : "string"
        },
        "appName" : {
          "description" : "The name of the application from which the event is being emitted. see go/appname",
          "type" : "string"
        },
        "messageId" : {
          "description" : "A unique identifier for the message",
          "$ref" : "#/definitions/UUID"
        },
        "auditVersion" : {
          "default" : null,
          "description" : "The version that is being used for auditing. In version 0, the audit trail buckets events into 10 minute audit windows based on the EventHeader timestamp. In version 1, the audit trail buckets events as follows: if the schema has an outer KafkaAuditHeader, use the outer audit header timestamp for bucketing; else if the EventHeader has an inner KafkaAuditHeader use that inner audit header's timestamp for bucketing",
          "type" : "integer",
          "minimum" : -2147483648,
          "maximum" : 2147483647
        },
        "fabricUrn" : {
          "default" : null,
          "description" : "The fabricUrn of the host from which the event is being emitted. Fabric Urn in the format of urn:li:fabric:{fabric_name}. See go/fabric.",
          "type" : "string"
        },
        "clusterConnectionString" : {
          "default" : null,
          "description" : "This is a String that the client uses to establish some kind of connection with the Kafka cluster. The exact format of it depends on specific versions of clients and brokers. This information could potentially identify the fabric and cluster with which the client is producing to or consuming from.",
          "type" : "string"
        }
      },
      "required" : [ "time", "server", "appName", "messageId" ]
    },
    "UUID" : {
      "type" : "string",
      "pattern" : "^[\u0000-Ã¿]*$",
      "minLength" : 16,
      "maxLength" : 16
    },
    "RelationshipChangeOperation" : {
      "enum" : [ "ADD", "REMOVE", "RESTATE" ]
    },
    "AuditStamp" : {
      "description" : "Data captured on a resource/association/sub-resource level giving insight into when that resource/association/sub-resource moved into a particular lifecycle stage, and who acted to move it into that specific lifecycle stage.",
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "time" : {
          "description" : "When did the resource/association/sub-resource move into the specific lifecycle stage represented by this AuditEvent.",
          "type" : "integer",
          "format" : "int64",
          "minimum" : -9223372036854775808,
          "maximum" : 9223372036854775807
        },
        "actor" : {
          "description" : "The entity (e.g. a member URN) which will be credited for moving the resource/association/sub-resource into the specific lifecycle stage. It is also the one used to authorize the change.",
          "type" : "string"
        },
        "impersonator" : {
          "default" : null,
          "description" : "The entity (e.g. a service URN) which performs the change on behalf of the Actor and must be authorized to act as the Actor.",
          "type" : "string"
        },
        "message" : {
          "default" : null,
          "description" : "Additional context around how DataHub was informed of the particular change. For example: was the change created by an automated process, or manually.",
          "type" : "string"
        }
      },
      "required" : [ "time", "actor" ]
    }
  },
  "$ref" : "#/definitions/RelationshipChangeEvent"
}